<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Schedule</title>
    <style>
      body { font-family: Arial, sans-serif; margin: 2rem; max-width: 800px; }
      nav a { margin-right: 1rem; }
      input { margin: 0.3rem 0; padding: 0.4rem; width: 100%; }
      button { margin-top: 0.5rem; padding: 0.6rem 1rem; }
      pre { background: #f5f5f5; padding: 1rem; border-radius: 8px; }
    </style>
  </head>
  <body>
    <h1>Schedule</h1>
    <nav>
      <a href="/">Home</a>
      <a href="/session">Session</a>
      <a href="/schedule">Schedule</a>
      <a href="/history">History</a>
    </nav>

    <p>Create a simple schedule and save it through the backend.</p>
    <input id="scheduleId" placeholder="Schedule ID (e.g. weekly-plan)" />
    <input id="taskName" placeholder="Task name" />
    <input id="taskDuration" type="number" min="1" value="25" placeholder="Task duration (minutes)" />
    <button id="saveBtn">Save Schedule</button>

    <pre id="output">No schedule submitted yet.</pre>

    <script>
      document.getElementById('saveBtn').addEventListener('click', async () => {
        const scheduleId = document.getElementById('scheduleId').value.trim();
        const taskName = document.getElementById('taskName').value.trim();
        const taskDuration = Number(document.getElementById('taskDuration').value || 25);
        const output = document.getElementById('output');

        if (!scheduleId || !taskName) {
          output.textContent = JSON.stringify({ error: 'Schedule ID and task name are required.' }, null, 2);
          return;
        }

        const payload = {
          id: scheduleId,
          tasks: [{
            id: crypto.randomUUID(),
            name: taskName,
            duration_minutes: taskDuration,
            completed: false
          }],
          intervals: [25, 5],
          recurrence: 'daily'
        };

        const res = await fetch('/schedule', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });
        const data = await res.json();
        output.textContent = JSON.stringify(data, null, 2);
      });
    </script>
  </body>
</html>
